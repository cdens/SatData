function bt = rad2bt(rad,channel)

% bt = rad2bt(rad,channel)
% Casey Densmore
% Converts satellite radiance to brightness temperature, given radiance
% values (rad) and IR channel (channel)

btdata = ...
    [7,  3.9,   2564.05, 2.00774e+05, 3.68909e+03, 0.50777, 0.99929;
     8,  6.15,  1617.05, 5.03614e+04, 2.32657e+03, 2.12504, 0.99541;
     9,  7.0,   1439.05, 3.54940e+04, 2.07047e+03, 0.33291, 0.9992;
     10, 7.4,   1362.00, 3.00925e+04, 1.95961e+03, 0.06984, 0.99983;
     11, 8.5,   1176.05, 1.93733e+04, 1.69207e+03, 0.17462, 0.99951;
     12, 9.7,   1041.05, 1.34382e+04, 1.49784e+03, 0.10861, 0.99966;
     13, 10.35, 966.00,  1.07364e+04, 1.38986e+03, 0.13445, 0.99955;
     14, 11.2,  893.05,  8.48310e+03, 1.28490e+03, 0.25361, 0.9991;
     15, 12.3,  813.05,  6.40146e+03, 1.16980e+03, 0.27049, 0.99894;
     16, 13.3,  752.05,  5.06603e+03, 1.08203e+03, 0.07574, 0.99968];

 chind = find(btdata(:,1) == channel);
 
 fk1 = btdata(chind,4);
 fk2 = btdata(chind,5);
 bc1 = btdata(chind,6);
 bc2 = btdata(chind,7);
 
 
 bt = (fk2./(log((fk1./rad)+ 1)) - bc1)./bc2;